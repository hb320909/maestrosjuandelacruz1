import{c as te}from"./vendor-5699f027.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function o(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(n){if(n.ep)return;n.ep=!0;const a=o(n);fetch(n.href,a)}})();const ne="https://upznvkoiiiazvnuowhdr.supabase.co",oe="sb_publishable_TaFJ0GGjMhmCGnGi4N4dyA_auGwFljE",j=te(ne,oe);function ae(t){document.readyState==="loading"?document.addEventListener("DOMContentLoaded",t):t()}let u=[],B=[],L=[],E={},I=[],P={};const z={Kati:"sun12",Alvaro:"rock34","Juan Ignacio":"wiz56","Maria Jose":"moon78","Jose Antonio":"thun90",Lourdes:"rain21",Ruben:"comet43",Belen:"star65",Adolfo:"king999"};function se(){I=[];const t=["A","B","C","D","E","F"],e=(o,s,n,a,i)=>{for(let r=o;r<=s;r++){const d=`${r}`,c={};t.forEach(m=>{c[m]=null}),I.push({number:d,capacity:6,occupied:0,beds:c,type:"para 6",gender:n,floor:a,side:i})}};e(101,104,"hombre",1,"izquierda"),e(201,202,"mujer",1,"derecha"),e(211,214,"hombre",2,"izquierda"),e(301,304,"mujer",2,"derecha")}function J(t){if(!t)return null;const e=new Date,o=new Date(t);if(isNaN(o))return null;let s=e.getFullYear()-o.getFullYear();const n=e.getMonth()-o.getMonth();return(n<0||n===0&&e.getDate()<o.getDate())&&s--,s}function ie(){const t=new Date,e=t.getMonth()+1,o=t.getDate(),s=u.filter(n=>{if(!n.fechaNacimiento)return!1;const a=new Date(n.fechaNacimiento+"T00:00:00");if(isNaN(a))return!1;const i=a.getMonth()+1,r=a.getDate();return i===e&&r===o});s.length>0&&re(s)}function re(t){const e=document.getElementById("birthdayModal"),o=document.getElementById("birthdayMessage");if(t.length===1)o.textContent=`Hoy es el cumpleaÃ±os de ${t[0].nombre}`;else{const s=t.map(n=>n.nombre).join(", ");o.textContent=`Â¡Hoy es el cumpleaÃ±os de ${s}!`}e.classList.remove("hidden"),de(),setTimeout(()=>{Y()},6e3)}function Y(){document.getElementById("birthdayModal").classList.add("hidden")}function de(){const t=document.getElementById("confettiContainer");if(!t)return;t.innerHTML="";const e=50,o=["#FF6B6B","#4ECDC4","#45B7D1","#FFA07A","#98D8C8","#F7DC6F","#BB8FCE"];for(let s=0;s<e;s++){const n=document.createElement("div");n.className="confetti-piece absolute w-2 h-2 rounded-full",n.style.left=Math.random()*100+"%",n.style.backgroundColor=o[Math.floor(Math.random()*o.length)],n.style.animationDelay=Math.random()*.5+"s",n.style.opacity="0.8",t.appendChild(n)}}async function T(){const{data:t,error:e}=await j.from("students").select("*");u=e?[]:t,e&&console.error("Error loading students:",e);const{data:o,error:s}=await j.from("absences").select("*");B=s?[]:o,s&&console.error("Error loading absences:",s);const{data:n,error:a}=await j.from("reports").select("*");L=a?[]:n,a&&console.error("Error loading reports:",a),se(),w(),N(),H(),S(),W(),$(),be(),O(),ie(),localStorage.setItem("students",JSON.stringify(u)),localStorage.setItem("absences",JSON.stringify(B)),localStorage.setItem("reports",JSON.stringify(L))}function v(){localStorage.setItem("students",JSON.stringify(u)),localStorage.setItem("absences",JSON.stringify(B)),localStorage.setItem("reports",JSON.stringify(L)),localStorage.setItem("homeworks",JSON.stringify(E)),localStorage.setItem("seguimientos",JSON.stringify(P))}async function ce(){await T(),le()}function le(){j.channel("schema-db-changes").on("postgres_changes",{event:"*",schema:"public",table:"students"},()=>T()).on("postgres_changes",{event:"*",schema:"public",table:"absences"},()=>T()).on("postgres_changes",{event:"*",schema:"public",table:"reports"},()=>T()).subscribe()}ce();document.getElementById("loginForm").addEventListener("submit",function(t){t.preventDefault();const e=document.getElementById("username").value,o=document.getElementById("password").value,s=document.getElementById("loginError");z[e]&&z[e]===o?(document.getElementById("currentUser").textContent=`Bienvenido, ${e}`,document.getElementById("loginScreen").classList.add("hidden"),document.getElementById("mainApp").classList.remove("hidden"),T(),M("dashboard"),s.classList.add("hidden")):(s.textContent="Usuario o contraseÃ±a incorrectos",s.classList.remove("hidden"))});document.getElementById("logoutBtn").addEventListener("click",function(){document.getElementById("username").value="",document.getElementById("password").value="",document.getElementById("loginScreen").classList.remove("hidden"),document.getElementById("mainApp").classList.add("hidden"),document.getElementById("loginError").classList.add("hidden")});document.querySelectorAll(".nav-link").forEach(t=>{t.addEventListener("click",function(e){e.preventDefault();const o=this.getAttribute("data-section");M(o)})});document.getElementById("mobileNav").addEventListener("change",function(){M(this.value)});var V;(V=document.getElementById("roomStudent"))==null||V.addEventListener("change",$);function M(t){document.querySelectorAll(".content-section").forEach(e=>{e.classList.add("hidden")}),document.getElementById(t).classList.remove("hidden")}document.getElementById("addStudentForm").addEventListener("submit",function(t){t.preventDefault();const e={id:Date.now(),nombre:document.getElementById("studentNombre").value,fechaNacimiento:document.getElementById("studentNacimiento").value,mayor16:!!document.getElementById("studentMayor16").checked,gender:document.getElementById("studentGenero").value,curso:document.getElementById("studentCurso").value,telefono1:document.getElementById("studentTelefono1").value,telefono2:document.getElementById("studentTelefono2").value,habitacion:null},o=J(e.fechaNacimiento);e.ageGroup=o!==null&&o>=18?"mayor":"menor",u.push(e),v(),w(),N(),$(),this.reset(),h(`Nuevo alumno aÃ±adido: ${e.nombre}`)});function w(){document.getElementById("totalAlumnos").textContent=u.length,document.getElementById("habitacionesOcupadas").textContent=I.filter(t=>t.occupied>0).length,document.getElementById("totalFaltas").textContent=B.length}function N(){const t=document.getElementById("studentsTableBody");if(u.length===0){t.innerHTML='<tr><td colspan="7" class="text-center py-8 text-gray-500">No hay alumnos registrados</td></tr>';return}t.innerHTML=u.map(e=>{const o=J(e.fechaNacimiento),n=new Date(e.fechaNacimiento+"T00:00:00").toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"});return`
        <tr class="border-b border-gray-100 hover:bg-gray-50">
            <td class="py-3 px-4 font-medium">${e.nombre}</td>
            <td class="py-3 px-4 text-sm">${n}</td>
            <td class="py-3 px-4"><span class="bg-indigo-100 text-indigo-800 px-2 py-1 rounded-full text-sm font-medium">${o} aÃ±os</span></td>
            <td class="py-3 px-4">${e.gender||"-"}</td>
            <td class="py-3 px-4">${e.curso}</td>
            <td class="py-3 px-4 text-sm text-gray-600">${e.telefono1||"-"}${e.telefono2?"<br/>"+e.telefono2:""}</td>
            <td class="py-3 px-4">
                ${e.habitacion?`<span class="bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs">${e.habitacion}</span>`:'<span class="bg-gray-100 text-gray-600 px-2 py-1 rounded-full text-xs">Sin asignar</span>'}
            </td>
            <td class="py-3 px-4">
                <button onclick="openStudentSeguimiento(${e.id})" title="Seguimiento acadÃ©mico" class="text-indigo-600 hover:text-indigo-800 mr-2">
                    <i class="fas fa-book"></i>
                </button>
                <button onclick="editStudent(${e.id})" class="text-blue-600 hover:text-blue-800 mr-2">
                    <i class="fas fa-edit"></i>
                </button>
                <button onclick="deleteStudent(${e.id})" class="text-red-600 hover:text-red-800">
                    <i class="fas fa-trash"></i>
                </button>
            </td>
        </tr>`}).join("")}function H(){const t=document.getElementById("roomsGrid"),e={1:{izquierda:[],derecha:[]},2:{izquierda:[],derecha:[]}};I.forEach(n=>{const a=n.floor||1,i=n.side||"izquierda";e[a]||(e[a]={izquierda:[],derecha:[]}),e[a][i].push(n)});const o=n=>{const a=Object.values(n.beds).filter(r=>r!==null).length,i=Object.keys(n.beds).sort();return`
        <div class="bg-white p-6 rounded-xl shadow-sm border-2 ${a===n.capacity?"border-red-300 bg-red-50":a>0?"border-yellow-300 bg-yellow-50":"border-green-300 bg-green-50"}">
            <div class="flex justify-between items-start mb-4">
                <div>
                    <h3 class="text-lg font-semibold text-gray-800">HabitaciÃ³n ${n.number}</h3>
                    <p class="text-sm text-gray-600">
                        <span class="font-medium">${n.gender==="hombre"?"ðŸ‘¨ Hombres":"ðŸ‘© Mujeres"}</span> 
                        Â· Planta ${n.floor}
                    </p>
                </div>
                <span class="px-3 py-1 rounded-full text-xs font-medium ${a===0?"bg-green-100 text-green-800":a===n.capacity?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}">${a}/${n.capacity}</span>
            </div>
            <div class="grid grid-cols-3 gap-2 mb-4">
                ${i.map(r=>{const d=n.beds[r],c=d?u.find(m=>m.id===d):null;return`
                        <div class="flex flex-col items-center p-3 rounded-lg ${c?"bg-indigo-100 border-2 border-indigo-300":"bg-gray-100 border-2 border-gray-300"}">
                            <span class="text-xs font-bold text-gray-600 mb-1">Cama ${r}</span>
                            ${c?`
                                <span class="text-xs text-center text-gray-700 font-medium">${c.nombre.split(" ")[0]}</span>
                            `:`
                                <span class="text-xs text-gray-500">Vacante</span>
                            `}
                        </div>
                    `}).join("")}
            </div>
            ${a<n.capacity?`<button onclick="assignRoomToStudent('${n.number}')" class="w-full bg-indigo-600 text-white py-2 px-4 rounded-lg text-sm font-medium hover:bg-indigo-700 transition-colors">Asignar</button>`:""}
        </div>
    `};let s="";[1,2].forEach(n=>{const a=e[n]||{izquierda:[],derecha:[]};s+=`
            <div class="mb-8">
                <h3 class="text-2xl font-bold text-gray-800 mb-6 border-b-2 border-indigo-600 pb-2">${n===1?"PLANTA 1":"PLANTA 2"}</h3>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <!-- Izquierda (Hombres) -->
                    <div>
                        <h4 class="text-lg font-semibold text-gray-700 mb-4 text-center p-3 bg-blue-100 rounded-lg">ðŸ‘¨ HOMBRES (Izquierda)</h4>
                        <div class="space-y-4">
                            ${a.izquierda.length>0?a.izquierda.map(r=>o(r)).join(""):'<p class="text-gray-500 text-center py-6">No hay habitaciones de hombres</p>'}
                        </div>
                    </div>
                    
                    <!-- Derecha (Mujeres) -->
                    <div>
                        <h4 class="text-lg font-semibold text-gray-700 mb-4 text-center p-3 bg-pink-100 rounded-lg">ðŸ‘© MUJERES (Derecha)</h4>
                        <div class="space-y-4">
                            ${a.derecha.length>0?a.derecha.map(r=>o(r)).join(""):'<p class="text-gray-500 text-center py-6">No hay habitaciones de mujeres</p>'}
                        </div>
                    </div>
                </div>
            </div>
        `}),t.innerHTML=s}function S(){const t=document.getElementById("absencesTableBody"),e=document.getElementById("filterStudent").value,o=document.getElementById("filterDate").value;let s=B;if(e&&(s=s.filter(n=>n.studentId==e)),o&&(s=s.filter(n=>n.fecha===o)),s.length===0){t.innerHTML='<tr><td colspan="4" class="text-center py-8 text-gray-500">No hay faltas registradas</td></tr>';return}t.innerHTML=s.map(n=>{const a=u.find(i=>i.id===n.studentId);return`
            <tr class="border-b border-gray-100 hover:bg-gray-50">
                <td class="py-3 px-4 font-medium">${a?`${a.nombre}`:"Alumno eliminado"}</td>
                <td class="py-3 px-4">${n.fecha}</td>
                <td class="py-3 px-4">${n.descripcion}</td>
                <td class="py-3 px-4">
                    <button onclick="deleteAbsence(${n.id})" class="text-red-600 hover:text-red-800">
                        <i class="fas fa-trash"></i>
                    </button>
                </td>
            </tr>
        `}).join("")}document.getElementById("assignRoomForm").addEventListener("submit",function(t){t.preventDefault();const e=parseInt(document.getElementById("roomStudent").value),o=document.getElementById("roomNumber").value,s=document.getElementById("roomBed")?document.getElementById("roomBed").value:"",n=u.find(d=>d.id===e),a=I.find(d=>d.number===o);if(!n||!a)return;const i=n.gender;if(a.gender&&a.gender!=="mixta"&&i!=="otro"&&a.gender!==i){alert("La habitaciÃ³n seleccionada no es compatible con el gÃ©nero del alumno.");return}let r=null;if(s){if(a.beds[s]!==null){alert(`La cama ${s} ya estÃ¡ ocupada en esta habitaciÃ³n.`);return}r=s}else r=Object.keys(a.beds).find(d=>a.beds[d]===null);if(!r){alert("La habitaciÃ³n estÃ¡ llena. No hay camas disponibles.");return}if(n.habitacion){const d=I.find(c=>c.number===n.habitacion);d&&n.cama&&(d.beds[n.cama]=null,d.occupied--)}n.habitacion=o,n.cama=r,a.beds[r]=e,a.occupied++,v(),w(),N(),H(),$(),this.reset(),h(`Asignada habitaciÃ³n ${o} cama ${r} a ${n.nombre}`)});document.getElementById("addAbsenceForm").addEventListener("submit",function(t){var s;t.preventDefault();const e={id:Date.now(),studentId:parseInt(document.getElementById("absenceStudent").value),fecha:document.getElementById("absenceDate").value,descripcion:document.getElementById("absenceDescription").value};B.push(e),v(),w(),S();const o=document.getElementById("alumnoResumenSelect");o&&o.value===e.studentId.toString()&&F(e.studentId),this.reset(),h(`Falta registrada para ${(s=u.find(n=>n.id===e.studentId))==null?void 0:s.nombre}`)});var U;(U=document.getElementById("addReportForm"))==null||U.addEventListener("submit",function(t){var s;if(!t)return;t.preventDefault();const e={id:Date.now(),studentId:parseInt(document.getElementById("reportStudent").value),fecha:document.getElementById("reportDate").value,tipo:document.getElementById("reportType").value,descripcion:document.getElementById("reportDescription").value};L.push(e),v(),W();const o=document.getElementById("alumnoResumenSelect");o&&o.value===e.studentId.toString()&&F(e.studentId),this.reset(),h(`Parte registrado para ${(s=u.find(n=>n.id===e.studentId))==null?void 0:s.nombre}`)});function $(){["roomStudent","absenceStudent","filterStudent","seguimientoStudent"].forEach(i=>{const r=document.getElementById(i),d=r.value;r.innerHTML='<option value="">Seleccionar alumno</option>'+u.map(c=>`
                <option value="${c.id}">${c.nombre}</option>
            `).join(""),r.value=d});const e=document.getElementById("reportStudent");if(e){const i=e.value;e.innerHTML='<option value="">Seleccionar alumno</option>'+u.map(r=>`
                <option value="${r.id}">${r.nombre}</option>
            `).join(""),e.value=i}const o=document.getElementById("seguimientoStudent");if(o){const i=o.value;o.innerHTML='<option value="">Seleccionar alumno</option>'+u.map(r=>`
                <option value="${r.id}">${r.nombre}</option>
            `).join(""),o.value=i,o.removeEventListener("change",A),o.addEventListener("change",function(){A(this.value)})}const s=document.getElementById("alumnoResumenSelect");if(s){const i=s.value;s.innerHTML='<option value="">-- Seleccionar alumno --</option>'+u.map(r=>`
                <option value="${r.id}">${r.nombre}</option>
            `).join(""),s.value=i,s.removeEventListener("change",F),s.addEventListener("change",function(){F(this.value)})}const n=document.getElementById("roomNumber");n.innerHTML='<option value="">Seleccionar habitaciÃ³n</option>'+I.map(i=>`
            <option value="${i.number}">${i.number} (${i.type}, ${i.occupied}/${i.capacity})</option>
        `).join("");const a=document.getElementById("roomStudent");a&&(a.removeEventListener("change",G),a.addEventListener("change",G),G()),document.getElementById("roomBed"),n&&(n.removeEventListener("change",q),n.addEventListener("change",q),q())}function q(){const t=document.getElementById("roomNumber"),e=document.getElementById("roomBed");if(!t||!e)return;const o=t.value;if(e.innerHTML='<option value="">Seleccionar cama</option>',!o){e.disabled=!0;return}const s=I.find(i=>i.number===o);if(!s){e.disabled=!0;return}const n=Object.keys(s.beds).sort();let a=!1;n.forEach(i=>{const r=s.beds[i];if(r===null)a=!0,e.innerHTML+=`<option value="${i}">Cama ${i} - Vacante</option>`;else{const d=u.find(m=>m.id===r),c=d?d.nombre.split(" ")[0]:"Ocupada";e.innerHTML+=`<option value="${i}" disabled>Cama ${i} - Ocupada (${c})</option>`}}),e.disabled=!a}function G(){const t=document.getElementById("roomNumber"),e=document.getElementById("roomStudent");if(!t||!e)return;const o=parseInt(e.value);let s=I;if(o){const a=u.find(i=>i.id===o);if(a){const i=a.gender;s=I.filter(r=>r.gender===i)}}const n=t.value;t.innerHTML='<option value="">Seleccionar habitaciÃ³n</option>'+s.map(a=>{const i=a.floor===1?"Planta 1":"Planta 2",r=a.side==="izquierda"?"Izquierda":"Derecha",d=a.gender==="hombre"?"Hombres":"Mujeres";return`
                <option value="${a.number}">${a.number} - ${i} (${d}, ${r}) - ${a.occupied}/${a.capacity}</option>
            `}).join(""),t.value=n}function W(){const t=document.getElementById("reportsTableBody");if(t){if(L.length===0){t.innerHTML='<tr><td colspan="5" class="text-center py-8 text-gray-500">No hay partes registrados</td></tr>';return}t.innerHTML=L.map(e=>{const o=u.find(s=>s.id===e.studentId);return`
            <tr class="border-b border-gray-100 hover:bg-gray-50">
                <td class="py-3 px-4 font-medium">${o?`${o.nombre}`:"Alumno eliminado"}</td>
                <td class="py-3 px-4">${e.fecha}</td>
                <td class="py-3 px-4">${e.tipo}</td>
                <td class="py-3 px-4">${e.descripcion}</td>
                <td class="py-3 px-4">
                    <button onclick="deleteReport(${e.id})" class="text-red-600 hover:text-red-800">
                        <i class="fas fa-trash"></i>
                    </button>
                </td>
            </tr>
        `}).join("")}}var K;(K=document.getElementById("addSeguimientoForm"))==null||K.addEventListener("submit",function(t){if(!t)return;t.preventDefault();const e=parseInt(document.getElementById("seguimientoStudent").value);if(!e){alert("Seleccione un alumno para registrar el seguimiento");return}const o=document.getElementById("seguimientoAsignatura").value,s=document.getElementById("seguimientoFecha").value,n=document.getElementById("seguimientoTipo").value,a=document.getElementById("seguimientoNota").value,i=document.getElementById("seguimientoComentarios").value,r=u.find(m=>m.id===e);if(!r)return;r.academic||(r.academic={records:[]});const d={id:Date.now(),fecha:s,asignatura:o,tipo:n,nota:a,comentarios:i};r.academic.records.push(d),v(),A(e);const c=document.getElementById("alumnoResumenSelect");c&&c.value===e.toString()&&F(e),this.reset(),h(`Registro acadÃ©mico aÃ±adido para ${r.nombre}: ${o}`)});function F(t){const e=document.getElementById("alumnoResumenCard"),o=document.getElementById("alumnoResumenNombre"),s=document.getElementById("alumnoResumenFaltas"),n=document.getElementById("alumnoResumenPartes"),a=document.getElementById("alumnoResumenSuspensas");if(!t){e.classList.add("hidden");return}const i=u.find(m=>m.id===parseInt(t));if(!i){e.classList.add("hidden");return}const r=B.filter(m=>m.studentId===parseInt(t)).length,d=L.filter(m=>m.studentId===parseInt(t)).length;let c=0;if(i.academic&&i.academic.records){const m=b=>{if(!b)return!1;const g=(b.nota||"").toString().trim().replace(",","."),l=parseFloat(g);if(!isNaN(l))return l<5;const p=((b.tipo||"")+" "+(b.comentarios||"")+" "+(b.asignatura||"")+" "+(b.nota||"")).toLowerCase();return!!(p.includes("susp")||p.includes("suspenso")||p.includes("np")||p.includes("no presentado"))};c=i.academic.records.filter(m).length}o.textContent=i.nombre,s.textContent=r,n.textContent=d,a.textContent=c,e.classList.remove("hidden")}function A(t){const e=document.getElementById("seguimientoSummary");if(!e)return;if(!t){e.innerHTML='<div class="text-center col-span-3 py-8"><p class="text-gray-500">Seleccione un alumno para ver sus suspensas por trimestre</p></div>';return}const o=u.find(r=>r.id===parseInt(t));if(!o||!o.academic||o.academic.records.length===0){e.innerHTML='<div class="text-center col-span-3 py-8"><p class="text-gray-500">No hay registros para este alumno</p></div>';return}const s=r=>{if(!r)return!1;const d=(r.nota||"").toString().trim().replace(",","."),c=parseFloat(d);if(!isNaN(c))return c<5;const b=((r.tipo||"")+" "+(r.comentarios||"")+" "+(r.asignatura||"")+" "+(r.nota||"")).toLowerCase();return!!(b.includes("susp")||b.includes("suspenso")||b.includes("np")||b.includes("no presentado"))},n=o.academic.records.filter(s);if(n.length===0){e.innerHTML='<div class="text-center col-span-3 py-8"><p class="text-green-600 text-lg font-semibold"><i class="fas fa-check-circle mr-2"></i>Ninguna asignatura suspensa</p></div>';return}const a={"Trimestre 1":{count:0,color:"red"},"Trimestre 2":{count:0,color:"orange"},"Trimestre 3":{count:0,color:"red"}};n.forEach(r=>{const c=new Date(r.fecha+"T00:00:00").getMonth()+1;c>=9&&c<=11?a["Trimestre 1"].count+=1:c>=12||c<=3?a["Trimestre 2"].count+=1:c>=4&&c<=8&&(a["Trimestre 3"].count+=1)});let i="";Object.entries(a).forEach(([r,d])=>{const c=d.count===0?"bg-green-50 border-green-300":"bg-red-50 border-red-300",m=d.count===0?"text-green-800":"text-red-800",b=d.count===0?"text-green-600":"text-red-600";i+=`
            <div class="border-2 ${c} rounded-lg p-6 text-center">
                <p class="text-sm font-medium text-gray-600 mb-2">${r}</p>
                <div class="text-4xl font-bold ${m} mb-2">
                    <i class="fas ${d.count===0?"fa-check-circle":"fa-times-circle"} ${b} mr-2"></i>${d.count}
                </div>
                <p class="text-sm ${m} font-semibold">${d.count===1?"asignatura suspensa":"asignaturas suspensas"}</p>
            </div>
        `}),e.innerHTML=i}function ue(t){M("seguimiento");const e=document.getElementById("seguimientoStudent");e&&(e.value=t,A(t))}function me(t){confirm("Â¿EstÃ¡ seguro de eliminar este parte?")&&(L=L.filter(e=>e.id!==t),v(),W(),h("Parte eliminado"))}document.getElementById("filterStudent").addEventListener("change",S);document.getElementById("filterDate").addEventListener("change",S);document.getElementById("clearFilters").addEventListener("click",function(){document.getElementById("filterStudent").value="",document.getElementById("filterDate").value="",S()});function ge(t){if(confirm("Â¿EstÃ¡ seguro de eliminar este alumno?")){const e=u.find(o=>o.id===t);if(e.habitacion){const o=I.find(s=>s.number===e.habitacion);o&&e.cama&&(o.beds[e.cama]=null,o.occupied--)}u=u.filter(o=>o.id!==t),B=B.filter(o=>o.studentId!==t),v(),w(),N(),H(),S(),$(),h(`Alumno eliminado: ${e.nombre}`)}}function fe(t){confirm("Â¿EstÃ¡ seguro de eliminar esta falta?")&&(B=B.filter(e=>e.id!==t),v(),w(),S(),h("Falta eliminada"))}function pe(t){const e=u.find(s=>s.id===t);if(!e)return;const o=prompt("Nuevo nombre:",e.nombre);o&&(e.nombre=o,v(),N(),$(),h(`Alumno actualizado: ${o}`))}function ye(t){const e=I.find(i=>i.number===t),o=Object.values(e.beds).filter(i=>i!==null).length;if(!e||o>=e.capacity)return;const s=u.filter(i=>!i.habitacion);if(s.length===0){alert("No hay alumnos sin habitaciÃ³n asignada");return}const n=Object.keys(e.beds).find(i=>e.beds[i]===null);if(!n){alert("La habitaciÃ³n estÃ¡ llena");return}const a=s[0];a.habitacion=t,a.cama=n,e.beds[n]=a.id,v(),w(),N(),H(),$(),h(`Asignada habitaciÃ³n ${t} cama ${n} a ${a.nombre}`)}function h(t){const e=document.getElementById("actividadReciente"),s=new Date().toLocaleString("es-ES"),n=document.createElement("div");for(n.className="flex items-center justify-between p-3 bg-gray-50 rounded-lg",n.innerHTML=`
        <div class="flex items-center space-x-3">
            <i class="fas fa-clock text-gray-400"></i>
            <span class="text-sm text-gray-700">${t}</span>
        </div>
        <span class="text-xs text-gray-500">${s}</span>
    `,e.children.length>0&&e.children[0].textContent.includes("No hay actividad reciente")&&(e.innerHTML=""),e.insertBefore(n,e.firstChild);e.children.length>10;)e.removeChild(e.lastChild)}function C(t){const e=new Date(t),o=(e.getDay()+6)%7;return e.setHours(0,0,0,0),e.setDate(e.getDate()-o),e.toISOString().slice(0,10)}function Q(t){const e=new Date(t+"T00:00:00");return e.setDate(e.getDate()+6),e.toISOString().slice(0,10)}function be(){const t=localStorage.getItem("homeworks");if(t)try{E=JSON.parse(t)}catch{E={}}else E={}}function X(){localStorage.setItem("homeworks",JSON.stringify(E))}let y=null;function he(){y||(y=C(new Date));const t=new Date(y+"T00:00:00");t.setDate(t.getDate()-7),y=t.toISOString().slice(0,10),O()}function ve(){y||(y=C(new Date));const t=new Date(y+"T00:00:00");t.setDate(t.getDate()+7),y=t.toISOString().slice(0,10),O()}function Ee(){y=C(new Date),O()}function Ie(){const t=document.getElementById("reviewPanel"),e=document.getElementById("reviewContent");if(!t)return;const o=Object.keys(E).sort().reverse();if(o.length===0){e.innerHTML=`
            <div class="text-center py-8">
                <p class="text-gray-500 text-lg">No hay deberes registrados aÃºn.</p>
            </div>
        `,t.classList.remove("hidden");return}let s=`
        <div class="space-y-4">
            <p class="text-sm text-gray-600 mb-4">Se encontraron <strong>${o.length}</strong> semana(s) con deberes registrados.</p>
    `;o.forEach(n=>{const a=Q(n),i=new Date(n+"T00:00:00"),r=new Date(a+"T00:00:00"),d=i.toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"}),c=r.toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"}),m=E[n]||{};Object.values(m).some(g=>g&&g.trim().length>0);const b=Object.entries(m).filter(([,g])=>g&&g.trim().length>0).length;s+=`
            <div class="border border-gray-300 rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer" onclick="showWeekReview('${n}')">
                <div class="flex items-center justify-between">
                    <div>
                        <h4 class="font-semibold text-gray-800">Semana: ${d} â†’ ${c}</h4>
                        <p class="text-sm text-gray-600 mt-1">
                            <i class="fas fa-book mr-1"></i>
                            ${b>0?`${b} estudio(s) con deberes`:"Sin deberes registrados"}
                        </p>
                    </div>
                    <div class="text-right">
                        <button onclick="loadWeekFromReview('${n}', event)" class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg font-semibold text-sm transition-colors">
                            <i class="fas fa-pencil-alt mr-1"></i>Editar
                        </button>
                    </div>
                </div>
                <div id="weekPreview_${n}" class="mt-3 text-sm text-gray-700 hidden">
                    <!-- Preview will be generated on click -->
                </div>
            </div>
        `}),s+="</div>",e.innerHTML=s,t.classList.remove("hidden")}function Z(){const t=document.getElementById("reviewPanel");t&&t.classList.add("hidden")}function Be(t){const e=document.getElementById(`weekPreview_${t}`);if(e)if(e.classList.contains("hidden")){const o=E[t]||{};let s='<div class="space-y-2 mt-2 pt-3 border-t border-gray-200">';for(let n=1;n<=4;n++){const a=`estudio${n}`,i=o[a]||"";i.trim().length>0&&(s+=`
                    <div class="pl-3 border-l-2 border-indigo-400">
                        <p class="font-medium text-gray-700">Estudio ${n}:</p>
                        <p class="text-gray-600 whitespace-pre-wrap text-sm">${i.substring(0,150)}${i.length>150?"...":""}</p>
                    </div>
                `)}s+="</div>",e.innerHTML=s,e.classList.remove("hidden")}else e.classList.add("hidden")}function xe(t,e){e.stopPropagation(),y=t,Z(),O(),document.getElementById("agenda").scrollIntoView({behavior:"smooth"})}function O(){const t=document.getElementById("agendaGrid"),e=document.getElementById("weekSelector");if(!t)return;y||(y=C(new Date));const o=y,s=Q(o),n=E[o]||{},a=new Date(o+"T00:00:00"),i=new Date(s+"T00:00:00"),r=a.toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"}),d=i.toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"});e.textContent=`${r} â†’ ${d}`;const m=C(new Date);let g=`<div class="mb-4">
        <h3 class="text-lg font-medium">Semana: ${o} â†’ ${s}</h3>
        ${o===m?'<p class="text-sm text-green-600 font-medium"><i class="fas fa-check-circle mr-1"></i>Esta es la semana actual</p>':'<p class="text-sm text-gray-500">Semana anterior/futura</p>'}
    </div>`;g+='<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">',g+="<!-- Estudios -->";for(let l=1;l<=4;l++){const f=`estudio${l}`,p=n&&n[f]?n[f]:"",x=p.trim().length>0;g+=`
            <div class="bg-white p-4 rounded-lg border ${x?"border-indigo-300 bg-indigo-50":"border-gray-200"}">
                <h4 class="text-md font-semibold mb-2 text-gray-800">Estudio ${l}</h4>
                <textarea id="homework_${f}" rows="6" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500" placeholder="Escribe los deberes para esta semana">${p}</textarea>
                <div class="mt-3 flex items-center justify-between gap-2">
                    <button onclick="saveHomework('${f}')" class="bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700 transition-colors">
                        <i class="fas fa-save mr-1"></i>Guardar
                    </button>
                    <button onclick="clearHomework('${f}')" class="text-sm text-gray-600 hover:text-gray-800 hover:bg-gray-100 px-2 py-1 rounded transition-colors">
                        <i class="fas fa-trash-alt mr-1"></i>Limpiar
                    </button>
                </div>
            </div>
        `}g+="</div>",t.innerHTML=g}function we(t){y||(y=C(new Date)),E[y]||(E[y]={});const e=document.getElementById(`homework_${t}`);e&&(E[y][t]=e.value,X(),h(`Deberes guardados para ${t} (${y})`),e.classList.add("ring-2","ring-green-300"),setTimeout(()=>e.classList.remove("ring-2","ring-green-300"),900))}function Se(t){const e=document.getElementById(`homework_${t}`);e&&confirm("Â¿Limpiar los deberes de esta semana para este estudio?")&&(e.value="",E[y]&&delete E[y][t],X(),h(`Deberes limpiados para ${t} (${y})`))}ae(()=>{const t=document.getElementById("absenceDate");t&&(t.valueAsDate=new Date);const e=document.getElementById("reportDate");e&&(e.valueAsDate=new Date)});document.addEventListener("DOMContentLoaded",function(){T();const t=document.getElementById("loginForm");t&&t.addEventListener("submit",function(g){g.preventDefault();const l=document.getElementById("username").value,f=document.getElementById("password").value,p=document.getElementById("loginError");z[l]&&z[l]===f?(document.getElementById("currentUser").textContent=`Bienvenido, ${l}`,document.getElementById("loginScreen").classList.add("hidden"),document.getElementById("mainApp").classList.remove("hidden"),T(),M("dashboard"),p.classList.add("hidden")):(p.textContent="Usuario o contraseÃ±a incorrectos",p.classList.remove("hidden"))});const e=document.getElementById("logoutBtn");e&&e.addEventListener("click",function(){document.getElementById("username").value="",document.getElementById("password").value="",document.getElementById("loginScreen").classList.remove("hidden"),document.getElementById("mainApp").classList.add("hidden"),document.getElementById("loginError").classList.add("hidden")}),document.querySelectorAll(".nav-link").forEach(g=>{g.addEventListener("click",function(l){l.preventDefault();const f=this.getAttribute("data-section");M(f)})});const o=document.getElementById("mobileNav");o&&o.addEventListener("change",function(){M(this.value)});const s=document.getElementById("roomStudent");s&&s.addEventListener("change",$);const n=document.getElementById("addStudentForm");n&&n.addEventListener("submit",function(g){g.preventDefault();const l={id:Date.now(),nombre:document.getElementById("studentNombre").value,fechaNacimiento:document.getElementById("studentNacimiento").value,mayor16:!!document.getElementById("studentMayor16").checked,gender:document.getElementById("studentGenero").value,curso:document.getElementById("studentCurso").value,telefono1:document.getElementById("studentTelefono1").value,telefono2:document.getElementById("studentTelefono2").value,habitacion:null},f=J(l.fechaNacimiento);l.ageGroup=f!==null&&f>=18?"mayor":"menor",u.push(l),v(),w(),N(),$(),this.reset(),h(`Nuevo alumno aÃ±adido: ${l.nombre}`)});const a=document.getElementById("assignRoomForm");a&&a.addEventListener("submit",function(g){g.preventDefault();const l=parseInt(document.getElementById("roomStudent").value),f=document.getElementById("roomNumber").value,p=document.getElementById("roomBed")?document.getElementById("roomBed").value:"",x=u.find(k=>k.id===l),D=I.find(k=>k.number===f);if(!x||!D)return;const _=x.gender;if(D.gender&&D.gender!=="mixta"&&_!=="otro"&&D.gender!==_){alert("La habitaciÃ³n seleccionada no es compatible con el gÃ©nero del alumno.");return}let R=null;if(p){if(D.beds[p]!==null){alert(`La cama ${p} ya estÃ¡ ocupada en esta habitaciÃ³n.`);return}R=p}else R=Object.keys(D.beds).find(k=>D.beds[k]===null);if(!R){alert("La habitaciÃ³n estÃ¡ llena. No hay camas disponibles.");return}if(x.habitacion){const k=I.find(ee=>ee.number===x.habitacion);k&&x.cama&&(k.beds[x.cama]=null,k.occupied--)}x.habitacion=f,x.cama=R,D.beds[R]=l,D.occupied++,v(),w(),N(),H(),$(),this.reset(),h(`Asignada habitaciÃ³n ${f} cama ${R} a ${x.nombre}`)});const i=document.getElementById("addAbsenceForm");i&&i.addEventListener("submit",function(g){var f;g.preventDefault();const l={id:Date.now(),studentId:parseInt(document.getElementById("absenceStudent").value),fecha:document.getElementById("absenceDate").value,descripcion:document.getElementById("absenceDescription").value};B.push(l),v(),w(),S(),this.reset(),h(`Nueva falta registrada para el alumno ${(f=u.find(p=>p.id===l.studentId))==null?void 0:f.nombre}`)});const r=document.getElementById("addReportForm");r&&r.addEventListener("submit",function(g){var f;g.preventDefault();const l={id:Date.now(),studentId:parseInt(document.getElementById("reportStudent").value),fecha:document.getElementById("reportDate").value,descripcion:document.getElementById("reportDescription").value};L.push(l),v(),w(),W(),this.reset(),h(`Nuevo informe registrado para el alumno ${(f=u.find(p=>p.id===l.studentId))==null?void 0:f.nombre}`)});const d=document.getElementById("addSeguimientoForm");d&&d.addEventListener("submit",function(g){var f;g.preventDefault();const l={id:Date.now(),studentId:parseInt(document.getElementById("seguimientoStudent").value),fecha:document.getElementById("seguimientoDate").value,descripcion:document.getElementById("seguimientoDescription").value};P[l.studentId]||(P[l.studentId]=[]),P[l.studentId].push(l),v(),A(l.studentId),this.reset(),h(`Nuevo seguimiento registrado para el alumno ${(f=u.find(p=>p.id===l.studentId))==null?void 0:f.nombre}`)});const c=document.getElementById("filterStudent");c&&c.addEventListener("change",S);const m=document.getElementById("filterDate");m&&m.addEventListener("change",S);const b=document.getElementById("clearFilters");b&&b.addEventListener("click",function(){document.getElementById("filterStudent").value="",document.getElementById("filterDate").value="",S()})});window.closeBirthdayModal=Y;window.openStudentSeguimiento=ue;window.deleteStudent=ge;window.deleteAbsence=fe;window.editStudent=pe;window.assignRoomToStudent=ye;window.previousWeek=he;window.nextWeek=ve;window.goToCurrentWeek=Ee;window.openReviewPanel=Ie;window.closeReviewPanel=Z;window.deleteReport=me;window.saveHomework=we;window.clearHomework=Se;window.loadWeekFromReview=xe;window.showWeekReview=Be;
//# sourceMappingURL=main-cee9f15e.js.map
